<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Project Hub — Minimal</title>
  <meta name="description" content="A minimal, single-file project hub for sharing context with AI assistants.">
  <style>
    :root{
      --bg:#0b0c10; --card:#151821; --ink:#e8e8ea; --muted:#a4a7b0; --accent:#7dd3fc;
      --ok:#86efac; --warn:#fde68a; --bad:#fca5a5; --line:#232634;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font:16px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',sans-serif}
    a{color:var(--accent);text-decoration:none}
    a:hover{text-decoration:underline}
    header{position:sticky;top:0;background:linear-gradient(180deg,rgba(11,12,16,.95),rgba(11,12,16,.65) 60%,transparent);backdrop-filter: blur(6px);z-index:5}
    .wrap{max-width:980px;margin:0 auto;padding:24px}
    .row{display:flex;gap:14px;flex-wrap:wrap}
    .card{background:var(--card);border:1px solid var(--line);border-radius:14px;padding:16px;box-shadow:0 2px 18px rgba(0,0,0,.25)}
    .title{font-weight:700;letter-spacing:.2px}
    .muted{color:var(--muted)}
    .pill{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);padding:6px 10px;border-radius:999px;font-size:12px}
    .btn{cursor:pointer;border:1px solid var(--line);background:#0f121a;color:var(--ink);padding:8px 12px;border-radius:12px}
    .btn:hover{background:#121623}
    .btn.primary{border-color:transparent;background:linear-gradient(180deg,#1e2637,#0f1523)}
    textarea, input[type="text"]{width:100%;background:#0f121a;color:var(--ink);border:1px solid var(--line);border-radius:10px;padding:10px}
    textarea{min-height:110px;resize:vertical}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:14px}
    .stack{display:grid;gap:10px}
    .list{display:grid;gap:8px;margin:0;padding:0;list-style:none}
    .list li{display:flex;gap:10px;align-items:flex-start;border:1px dashed var(--line);border-radius:12px;padding:10px}
    .list input[type="checkbox"]{margin-top:3px}
    .small{font-size:12px}
    .code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;background:#0f121a;border:1px solid var(--line);padding:10px;border-radius:10px;overflow:auto}
    .flex{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .right{margin-left:auto}
    .badge{font-size:11px;padding:4px 8px;border-radius:999px;background:#0f121a;border:1px solid var(--line)}
    .ok{color:var(--ok)} .warn{color:var(--warn)} .bad{color:var(--bad)}
    .footer{color:var(--muted);font-size:12px;margin-top:16px}
    .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;}
    .kbd{border:1px solid var(--line);background:#0f121a;border-bottom-width:2px;padding:2px 6px;border-radius:6px;font-size:12px}
    .hl{background:#111626;border-radius:8px;padding:8px}
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0}
  </style>
</head>
<body>
  <header>
    <div class="wrap">
      <div class="row">
        <div class="pill"><strong>Project Hub</strong><span class="muted">Minimal</span></div>
        <span class="badge">Local Save</span>
        <span class="badge">Single-file</span>
        <span class="badge">Ad-free</span>
        <span class="right small muted">Tip: Press <span class="kbd">/</span> to open Quick Add</span>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="card stack">
      <div class="flex">
        <div class="title">1) Overview</div>
        <button class="btn right" id="saveBtn">Save</button>
        <button class="btn" id="exportBtn">Export JSON</button>
        <label class="btn" for="importFile">Import JSON</label>
        <input id="importFile" class="sr-only" type="file" accept="application/json">
      </div>
      <textarea id="overview" placeholder="What is this project? Goals, constraints, deadlines."></textarea>
      <div class="grid">
        <div class="stack">
          <div class="title">2) Links</div>
          <div class="flex">
            <input id="linkText" type="text" placeholder="Label (e.g., GitHub repo)">
            <input id="linkUrl" type="text" placeholder="https://...">
            <button class="btn" id="addLink">Add</button>
          </div>
          <ul class="list" id="links"></ul>
        </div>
        <div class="stack">
          <div class="title">3) Artifacts</div>
          <div class="flex">
            <input id="artifactText" type="text" placeholder="Artifact description (e.g., Checkpoint v1.2)">
            <input id="artifactUrl" type="text" placeholder="URL (Drive/S3/etc., optional)">
            <button class="btn" id="addArtifact">Add</button>
          </div>
          <ul class="list" id="artifacts"></ul>
        </div>
      </div>
    </section>

    <section class="grid">
      <div class="card stack">
        <div class="flex">
          <div class="title">4) Tasks</div>
          <span class="muted small">Mark as done to move to Completed.</span>
        </div>
        <div class="flex">
          <input id="taskText" type="text" placeholder="Task detail">
          <input id="taskOwner" type="text" placeholder="Owner (optional)">
          <button class="btn" id="addTask">Add</button>
        </div>
        <ul class="list" id="tasks"></ul>
        <div class="title">Completed</div>
        <ul class="list" id="done"></ul>
      </div>

      <div class="card stack">
        <div class="flex">
          <div class="title">5) Decisions & Notes</div>
          <span class="muted small">Single source of truth.</span>
        </div>
        <div class="flex">
          <input id="noteText" type="text" placeholder="Decision/Note">
          <button class="btn" id="addNote">Add</button>
        </div>
        <ul class="list" id="notes"></ul>
      </div>
    </section>

    <section class="grid">
      <div class="card stack">
        <div class="title">6) Blockers</div>
        <div class="flex">
          <input id="blockerText" type="text" placeholder="What's blocking progress?">
          <button class="btn" id="addBlocker">Add</button>
        </div>
        <ul class="list" id="blockers"></ul>
      </div>

      <div class="card stack">
        <div class="flex">
          <div class="title">7) Activity Log</div>
          <span class="muted small">Stamp your progress.</span>
        </div>
        <div class="flex">
          <input id="logText" type="text" placeholder="What happened?">
          <button class="btn" id="addLog">Add</button>
        </div>
        <ul class="list" id="logs"></ul>
      </div>
    </section>

    <section class="card stack">
      <div class="flex">
        <div class="title">8) Share With AI</div>
        <button class="btn right" id="copyBrief">Copy AI Brief</button>
      </div>
      <div class="muted small">Generates a concise context pack from your entries (excluding URLs marked <span class="mono">private</span>).</div>
      <pre class="code" id="aiBrief" aria-live="polite"></pre>
      <div class="footer">Paste the brief into ChatGPT/Grok. Share this page URL if public. Avoid pasting secrets; mark sensitive links with the label <span class="mono">private</span>.</div>
    </section>

    <section class="card">
      <div class="title">Basic Usage</div>
      <div class="hl small">
        <p>• Your data saves to <strong>localStorage</strong> in your browser. Use <em>Export JSON</em> to back up or move between devices; <em>Import JSON</em> to load it.</p>
        <p>• To publish for free: push this file to a GitHub repo and enable <strong>Pages</strong>, or drop it on <strong>Netlify</strong>/<strong>Cloudflare Pages</strong>.</p>
        <p>• Keyboard: Press <span class="kbd">/</span> to open Quick Add, then choose Tasks/Note/Log with <span class="kbd">t</span>/<span class="kbd">n</span>/<span class="kbd">l</span>.</p>
      </div>
    </section>

    <div class="footer small muted">v1.0 — Single-file Minimal Hub</div>
  </main>

<script>
(function(){
  const $ = sel => document.querySelector(sel);
  const $$ = sel => document.querySelectorAll(sel);
  const state = {
    overview: "",
    links: [],       // {text,url}
    artifacts: [],   // {text,url}
    tasks: [],       // {id,text,owner,done:false}
    done: [],        // moved tasks
    notes: [],       // {text,ts}
    blockers: [],    // {text,ts,open:true}
    logs: []         // {text,ts}
  };
  const LS_KEY = "project_hub_minimal_v1";

  // Load
  function load(){
    const raw = localStorage.getItem(LS_KEY);
    if(!raw) return;
    try{
      const s = JSON.parse(raw);
      Object.assign(state, s);
    }catch(e){ console.error("Bad state", e); }
  }

  // Save
  function save(){
    localStorage.setItem(LS_KEY, JSON.stringify(state));
    buildBrief();
    toast("Saved");
  }

  function toast(msg){
    const t = document.createElement('div');
    t.textContent = msg;
    t.style.position='fixed'; t.style.bottom='20px'; t.style.right='20px';
    t.style.padding='8px 12px'; t.style.background='#0f121a'; t.style.border='1px solid #232634';
    t.style.borderRadius='10px'; t.style.boxShadow='0 6px 22px rgba(0,0,0,.35)';
    document.body.appendChild(t);
    setTimeout(()=> t.remove(), 1200);
  }

  // Render helpers
  function li(content){
    const li = document.createElement('li');
    li.innerHTML = content;
    return li;
  }
  function time(){
    const d = new Date();
    return d.toISOString().replace('T',' ').slice(0,16);
  }

  // Setup UI refs
  const overview = $("#overview");
  const links = $("#links");
  const artifacts = $("#artifacts");
  const tasks = $("#tasks");
  const done = $("#done");
  const notes = $("#notes");
  const blockers = $("#blockers");
  const logs = $("#logs");
  const aiBrief = $("#aiBrief");

  // Populate
  function render(){
    overview.value = state.overview || "";

    links.innerHTML = "";
    state.links.forEach((it, i)=>{
      const priv = /\bprivate\b/i.test(it.text);
      links.appendChild(li(`
        <div class="stack" style="flex:1">
          <div><a href="${it.url||'#'}" target="_blank" rel="noopener">${escapeHtml(it.text||"(no label)")}</a></div>
          <div class="small muted">${priv ? "Marked private — excluded from AI brief" : (it.url||"")}</div>
        </div>
        <button class="btn small" data-act="delLink" data-i="${i}">Delete</button>
      `));
    });

    artifacts.innerHTML = "";
    state.artifacts.forEach((it, i)=>{
      artifacts.appendChild(li(`
        <div class="stack" style="flex:1">
          <div>${escapeHtml(it.text||"(no description)")}</div>
          <div class="small muted">${it.url||""}</div>
        </div>
        <button class="btn small" data-act="delArtifact" data-i="${i}">Delete</button>
      `));
    });

    tasks.innerHTML = "";
    state.tasks.forEach((t,i)=>{
      tasks.appendChild(li(`
        <input type="checkbox" data-act="toggleTask" data-i="${i}">
        <div class="stack" style="flex:1">
          <div>${escapeHtml(t.text)}</div>
          <div class="small muted">${t.owner?("Owner: "+escapeHtml(t.owner)):""}</div>
        </div>
        <button class="btn small" data-act="delTask" data-i="${i}">Delete</button>
      `));
    });

    done.innerHTML = "";
    state.done.forEach((t,i)=>{
      done.appendChild(li(`
        <span class="ok">✓</span>
        <div class="stack" style="flex:1">
          <div>${escapeHtml(t.text)}</div>
          <div class="small muted">${t.owner?("Owner: "+escapeHtml(t.owner)):""}</div>
        </div>
        <button class="btn small" data-act="delDone" data-i="${i}">Delete</button>
      `));
    });

    notes.innerHTML = "";
    state.notes.forEach((n,i)=>{
      notes.appendChild(li(`
        <div class="stack" style="flex:1">
          <div>${escapeHtml(n.text)}</div>
          <div class="small muted">${n.ts}</div>
        </div>
        <button class="btn small" data-act="delNote" data-i="${i}">Delete</button>
      `));
    });

    blockers.innerHTML = "";
    state.blockers.forEach((b,i)=>{
      blockers.appendChild(li(`
        <div class="stack" style="flex:1">
          <div>${escapeHtml(b.text)}</div>
          <div class="small muted">${b.ts}</div>
        </div>
        <button class="btn small" data-act="delBlocker" data-i="${i}">Delete</button>
      `));
    });

    logs.innerHTML = "";
    state.logs.forEach((l,i)=>{
      logs.appendChild(li(`
        <div class="stack" style="flex:1">
          <div>${escapeHtml(l.text)}</div>
          <div class="small muted">${l.ts}</div>
        </div>
        <button class="btn small" data-act="delLog" data-i="${i}">Delete</button>
      `));
    });

    buildBrief();
  }

  function buildBrief(){
    const priv = (x) => /\bprivate\b/i.test(x||"");
    const lines = [];
    lines.push(`# Project Brief`);
    lines.push(`Generated: ${time()}`);
    lines.push("");
    if(state.overview?.trim()){
      lines.push(`## Overview`);
      lines.push(state.overview.trim());
      lines.push("");
    }
    const pubLinks = state.links.filter(l=>!priv(l.text));
    if(pubLinks.length){
      lines.push(`## Public Links`);
      pubLinks.forEach(l=> lines.push(`- ${l.text}: ${l.url}`));
      lines.push("");
    }
    if(state.artifacts.length){
      lines.push(`## Artifacts`);
      state.artifacts.forEach(a=> lines.push(`- ${a.text}${a.url?(" — "+a.url):""}`));
      lines.push("");
    }
    if(state.tasks.length){
      lines.push(`## Open Tasks`);
      state.tasks.forEach(t=> lines.push(`- ${t.text}${t.owner?(" (Owner: "+t.owner+")"):""}`));
      lines.push("");
    }
    if(state.blockers.length){
      lines.push(`## Blockers`);
      state.blockers.forEach(b=> lines.push(`- ${b.text}`));
      lines.push("");
    }
    if(state.notes.length){
      lines.push(`## Key Decisions/Notes`);
      state.notes.forEach(n=> lines.push(`- ${n.text}`));
      lines.push("");
    }
    if(state.logs.length){
      lines.push(`## Recent Activity`);
      const last = state.logs.slice(-5);
      last.forEach(l=> lines.push(`- ${l.ts}: ${l.text}`));
      lines.push("");
    }
    lines.push(`## Ask the AI`);
    lines.push(`Please read the brief above. Given the context, help by doing one of the following:`);
    lines.push(`1) Unblock a blocker  2) Complete the top open task  3) Propose the next concrete step.`);
    aiBrief.textContent = lines.join("\n");
  }

  // Escape HTML to prevent injection
  function escapeHtml(str=""){
    return str.replace(/[&<>"']/g, (m)=>({ "&":"&amp;", "<":"&lt;", ">":"&gt;", '"':"&quot;", "'":"&#039;" }[m]));
  }

  // Event wiring
  $("#saveBtn").addEventListener("click", ()=>{ state.overview = overview.value; save(); render(); });
  $("#exportBtn").addEventListener("click", ()=>{
    const blob = new Blob([JSON.stringify(state,null,2)], {type: "application/json"});
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url; a.download = "project-hub-export.json"; a.click();
    URL.revokeObjectURL(url);
  });
  $("#importFile").addEventListener("change", (e)=>{
    const f = e.target.files[0]; if(!f) return;
    const reader = new FileReader();
    reader.onload = (ev)=>{
      try{
        const parsed = JSON.parse(ev.target.result);
        Object.assign(state, parsed);
        save(); render();
      }catch(err){ alert("Import failed: invalid JSON"); }
    };
    reader.readAsText(f);
  });

  $("#addLink").addEventListener("click", ()=>{
    const text = $("#linkText").value.trim();
    const url = $("#linkUrl").value.trim();
    if(!text) return;
    state.links.push({text,url});
    $("#linkText").value=""; $("#linkUrl").value="";
    save(); render();
  });
  $("#addArtifact").addEventListener("click", ()=>{
    const text = $("#artifactText").value.trim();
    const url = $("#artifactUrl").value.trim();
    if(!text) return;
    state.artifacts.push({text,url});
    $("#artifactText").value=""; $("#artifactUrl").value="";
    save(); render();
  });
  $("#addTask").addEventListener("click", ()=>{
    const text = $("#taskText").value.trim();
    if(!text) return;
    const owner = $("#taskOwner").value.trim();
    state.tasks.push({id:crypto.randomUUID(), text, owner, done:false});
    $("#taskText").value=""; $("#taskOwner").value="";
    save(); render();
  });
  $("#addNote").addEventListener("click", ()=>{
    const text = $("#noteText").value.trim();
    if(!text) return;
    state.notes.push({text, ts: time()});
    $("#noteText").value="";
    save(); render();
  });
  $("#addBlocker").addEventListener("click", ()=>{
    const text = $("#blockerText").value.trim();
    if(!text) return;
    state.blockers.push({text, ts: time(), open:true});
    $("#blockerText").value="";
    save(); render();
  });
  $("#addLog").addEventListener("click", ()=>{
    const text = $("#logText").value.trim();
    if(!text) return;
    state.logs.push({text, ts: time()});
    $("#logText").value="";
    save(); render();
  });

  document.body.addEventListener("click", (e)=>{
    const act = e.target.getAttribute("data-act");
    const i = +e.target.getAttribute("data-i");
    if(!act) return;
    switch(act){
      case "delLink": state.links.splice(i,1); break;
      case "delArtifact": state.artifacts.splice(i,1); break;
      case "delTask": state.tasks.splice(i,1); break;
      case "delDone": state.done.splice(i,1); break;
      case "delNote": state.notes.splice(i,1); break;
      case "delBlocker": state.blockers.splice(i,1); break;
      case "delLog": state.logs.splice(i,1); break;
      case "toggleTask":
        const t = state.tasks.splice(i,1)[0];
        if(t){ t.done=true; state.done.push(t); }
        break;
    }
    save(); render();
  });

  $("#copyBrief").addEventListener("click", async ()=>{
    try{
      await navigator.clipboard.writeText(aiBrief.textContent);
      toast("AI brief copied");
    }catch(e){ alert("Copy failed. Select and copy manually."); }
  });

  // Quick Add modal (super minimal)
  let qaOpen = false;
  const qa = document.createElement('div');
  qa.style.position='fixed'; qa.style.inset='0'; qa.style.display='none'; qa.style.alignItems='center'; qa.style.justifyContent='center';
  qa.innerHTML = `
    <div class="card" style="max-width:560px;width:92vw">
      <div class="title">Quick Add</div>
      <div class="small muted" style="margin-bottom:8px">Press <span class="kbd">t</span> Task, <span class="kbd">n</span> Note, <span class="kbd">l</span> Log. <span class="right"></span></div>
      <input id="qaInput" type="text" placeholder="Type then Enter">
      <div class="flex" style="margin-top:8px">
        <span class="badge">Target: <span id="qaTarget">Task</span></span>
        <button class="btn right" id="qaClose">Close</button>
      </div>
    </div>`;
  document.body.appendChild(qa);
  const qaInput = ()=> document.getElementById("qaInput");
  const qaTarget = ()=> document.getElementById("qaTarget");

  function openQA(){ qa.style.display='flex'; qaOpen=true; qaInput().focus(); qaTarget().textContent="Task"; qa.setAttribute('data-mode','task'); }
  function closeQA(){ qa.style.display='none'; qaOpen=false; }

  document.addEventListener("keydown", (e)=>{
    if(e.key === "/" && !qaOpen && e.target.tagName!=="INPUT" && e.target.tagName!=="TEXTAREA"){ e.preventDefault(); openQA(); }
    if(qaOpen){
      if(e.key === "Escape"){ closeQA(); }
      if(e.key.toLowerCase() === "t"){ qa.setAttribute('data-mode','task'); qaTarget().textContent="Task"; }
      if(e.key.toLowerCase() === "n"){ qa.setAttribute('data-mode','note'); qaTarget().textContent="Note"; }
      if(e.key.toLowerCase() === "l"){ qa.setAttribute('data-mode','log'); qaTarget().textContent="Log"; }
      if(e.key === "Enter"){
        const v = qaInput().value.trim(); if(!v) return;
        const mode = qa.getAttribute('data-mode');
        if(mode==="task") state.tasks.push({id:crypto.randomUUID(), text:v, owner:"", done:false});
        if(mode==="note") state.notes.push({text:v, ts: time()});
        if(mode==="log") state.logs.push({text:v, ts: time()});
        qaInput().value="";
        save(); render();
        closeQA();
      }
    }
  });
  $("#qaClose").addEventListener("click", closeQA);

  // Init
  load();
  render();
  // persist overview edits when leaving field
  overview.addEventListener("blur", ()=>{ state.overview = overview.value; save(); });

})();
</script>

</body>
</html>
