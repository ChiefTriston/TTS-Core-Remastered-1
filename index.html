# Create a dead-simple, recursive GitHub repo browser index.html
# Minimal JS, no styling bloat. Works on GitHub Pages. Lists all files/folders recursively.
owner = "ChiefTriston"
repo = "TTS-Core-Remastered-1"
branch = "main"

html = f"""<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{repo} — Files</title>
</head>
<body>
<h2>{repo} — All Files</h2>
<div id="status">Loading…</div>
<ul id="tree"></ul>

<script>
const OWNER = "{owner}";
const REPO = "{repo}";
const BRANCH = "{branch}";
const API = (p="") => `https://api.github.com/repos/${{OWNER}}/${{REPO}}/contents/${{p}}?ref=${{BRANCH}}`;
const RAW = (p) => `https://raw.githubusercontent.com/${{OWNER}}/${{REPO}}/${{BRANCH}}/${{p}}`;
const BLOB = (p) => `https://github.com/${{OWNER}}/${{REPO}}/blob/${{BRANCH}}/${{p}}`;

async function fetchDir(path=""){{
  const r = await fetch(API(path));
  if(!r.ok) throw new Error("GitHub API " + r.status);
  return r.json();
}}

async function build(path="", ul){{
  const items = await fetchDir(path);
  // sort: dirs first, then files
  items.sort((a,b)=> a.type===b.type ? a.name.localeCompare(b.name) : (a.type==="dir" ? -1 : 1));
  for(const it of items){{
    const li = document.createElement("li");
    if(it.type === "dir"){{  // folder
      li.textContent = it.path + "/";
      const sub = document.createElement("ul");
      li.appendChild(sub);
      ul.appendChild(li);
      await build(it.path, sub); // recursive
    }} else {{                  // file
      const a = document.createElement("a");
      a.href = BLOB(it.path);   // link to GitHub viewer (bots can read)
      a.textContent = it.path;
      a.target = "_blank";
      li.appendChild(a);
      // also add raw link (small)
      const raw = document.createElement("a");
      raw.href = RAW(it.path);
      raw.textContent = " [raw]";
      raw.target = "_blank";
      li.appendChild(raw);
      ul.appendChild(li);
    }}
  }}
}}

(async ()=>{{
  try{{
    await build("", document.getElementById("tree"));
    document.getElementById("status").textContent = "";
  }}catch(e){{
    document.getElementById("status").textContent = String(e);
  }}
}})();
</script>
</body>
</html>
"""
path = "/mnt/data/index_minimal_recursive.html"
open(path,'w',encoding='utf-8').write(html)
path
